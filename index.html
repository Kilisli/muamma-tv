<?php
ob_start();
header('Content-Type: text/html; charset=utf-8');
?>
<!DOCTYPE html>
<html lang="tr">
<head>
	<title>Youtube den canlı yayın PHP AJAX</title>
	<meta charset="utf-8">
	
	<script src="http://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script type="text/javascript">
var yenile = true; //yenile değişkeni true ayarladık
// sürekli yenileyerek canlı yayın varsa oynatılan videoyu canlı yayın adresi ile değiştiren function
function YayinKontrol(){
	if(yenile){
		$.getJSON("php/youtube.php?canlikontrol", function(control) {
			if(control.items.length > 0){
				$("#trt1").attr("src", "https://www.youtube.com/embed/" + control.items[0].id.videoId + "?autoplay=1");
				yenile = false; //yenile değişkeni false yayın var artık yenilemesin
			}
		});
		setTimeout(function(){
			YayinKontrol(); //tekrar tekrar istek gönder;
		}, 10000); // yenileme süresi 10sn 
	}
}
</script>

</head>

<body>

<?php include("php/youtube.php"); ?>

</body>
</html>
<?php
ob_end_flush();
?>
